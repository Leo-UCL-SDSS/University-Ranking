<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>U.S. News University Ranking</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="CSS Assessment II_files/libs/clipboard/clipboard.min.js"></script>
<script src="CSS Assessment II_files/libs/quarto-html/quarto.js"></script>
<script src="CSS Assessment II_files/libs/quarto-html/popper.min.js"></script>
<script src="CSS Assessment II_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="CSS Assessment II_files/libs/quarto-html/anchor.min.js"></script>
<link href="CSS Assessment II_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="CSS Assessment II_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="CSS Assessment II_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="CSS Assessment II_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="CSS Assessment II_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul class="collapse">
  <li><a href="#part-i-a-automated-data-collection" id="toc-part-i-a-automated-data-collection" class="nav-link active" data-scroll-target="#part-i-a-automated-data-collection">Part I-A Automated Data Collection</a></li>
  <li><a href="#part-i-b-data-exploration-and-contextualisation" id="toc-part-i-b-data-exploration-and-contextualisation" class="nav-link" data-scroll-target="#part-i-b-data-exploration-and-contextualisation">Part I B-Data Exploration and Contextualisation</a></li>
  <li><a href="#part-ii-a-building-an-interactive-dashborad-with-r-shiny" id="toc-part-ii-a-building-an-interactive-dashborad-with-r-shiny" class="nav-link" data-scroll-target="#part-ii-a-building-an-interactive-dashborad-with-r-shiny">Part II A-Building an Interactive Dashborad with R Shiny</a></li>
  <li><a href="#part-ii-c-critical-engagement-with-ai-chat-gpt" id="toc-part-ii-c-critical-engagement-with-ai-chat-gpt" class="nav-link" data-scroll-target="#part-ii-c-critical-engagement-with-ai-chat-gpt">Part II C-Critical Engagement with AI: Chat GPT</a></li>
  <li><a href="#reference-list" id="toc-reference-list" class="nav-link" data-scroll-target="#reference-list">Reference List</a></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="CSS Assessment II.html"><i class="bi bi-file-slides"></i>RevealJS</a></li></ul></div></nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">U.S. News University Ranking</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="part-i-a-automated-data-collection" class="level2">
<h2 class="anchored" data-anchor-id="part-i-a-automated-data-collection">Part I-A Automated Data Collection</h2>
<p>This study adopts a dynamic web-scraping method to explore the significance of university rankings through the U.S. News website, as API is not available. Using the Firefox browser, a remote driver object is created. Then, the <code>navigate</code> function from the RSelenium package directs the browser to the webpage using the assigned URL for the 2024-2025 global university ranking by U.S. News. Since the website requires users to accept or reject cookies, the accept button element is located by inspecting its ID, and the button is subsequently clicked using the Selenium package.</p>
<p>Now, the ranking data can be scraped. The webpage includes the following information: the names of universities, ranks, locations, overall scores, and enrollment numbers. For certain universities, such as Harvard and MIT, a short abstract is also included, requiring a click on “Read More” to display the full message. Using the <code>findElement</code> function, the XPaths of elements such as name, rank, and abstract are identified to enable R to extract all the university information. By inspecting the class attribute of the HTML structure, R is able to fetch all the data associated with the class, such as <code>h2</code> for university names and <code>p</code> for abstracts.</p>
<p>The website requires scrolling down to load all universities, and a specific “Load More” button, located near the bottom of the webpage (but not exactly at the bottom), needs to be clicked after a certain number of scrolls. The number of scrolls required appears to vary. To handle this, a JavaScript function <code>executeScript</code> is adopted to scroll the window to 80% of the page height, ensuring the “Load More” button is visible. This approach is derived from the YouTube tutorial referenced in the Week 6 lecture slides. To handle potential errors, such as when the “Load More” button fails to appear, a <code>tryCatch</code> function is employed. This function prints a success reminder if the button is successfully located and clicked or provides a failure message to inform the user otherwise.</p>
<p>To scrape the maximum amount of data, a loop function is implemented to repeat the scrolling and loading process 25 times, which access sufficient data without over-loading the website. After completing 25 iterations, a substantial amount of university information is loaded onto the webpage, which can then be scraped using the identified XPaths as discussed earlier. Information from 220 universities is subsequently gathered. However, during multiple tests, the scrolling is still unstable in locating the button, as the location of the button varies, requiring adjustment in future study.</p>
<p>As the collected data is in web element type, it must be transformed into text to create a table. A table, <code>usNews_ranking</code>, is created using the <code>tibble</code> function, which allows for flexible manipulation of columns. The rank data is transformed into text using both the <code>sapply</code> and <code>getElementText</code> functions, and the same method is applied to the remaining columns. Consequently, a table with nine variables and 220 observations is constructed.</p>
</section>
<section id="part-i-b-data-exploration-and-contextualisation" class="level2">
<h2 class="anchored" data-anchor-id="part-i-b-data-exploration-and-contextualisation">Part I B-Data Exploration and Contextualisation</h2>
<p>The table is first converted to a data frame using the <code>as.data.frame</code> function, and variables such as rank, score, and year founded are treated as numeric. Specifically, the “#” symbol is removed to create the numeric rank data, and the year founded is extracted by identifying four-digit numbers within the abstract text. Missing values are assigned for any blank spaces, and the last 20 rows of the dataset are removed to create a table containing 200 universities for a clearer view of highest-quality instituions. Using the <code>mutate</code> function, a location variable is created by combining the city and country columns. Latitude and longitude coordinates for each university’s location are added using a geocoding function with the OpenStreetMap (OSM) method. Finally, the dataset is saved as a CSV file to ensure reproducibility and further analysis.</p>
<p>The <code>usNews_ranking</code> dataset contains 12 variables, each providing specific information about universities. Notably:</p>
<div class="nonincremental">
<ul>
<li><strong>rank</strong>: University rank (#)</li>
<li><strong>name</strong>: University name</li>
<li><strong>country</strong>: Country of the university</li>
<li><strong>city</strong>: City of the university</li>
<li><strong>enrollment</strong>: Number of students enrolled</li>
<li><strong>score</strong>: Overall score assigned by U.S. News</li>
<li><strong>abstract</strong>: A brief introduction to the university</li>
<li><strong>numeric_rank</strong>: Numeric representation of the university’s rank</li>
<li><strong>year_founded</strong>: Year the university was established</li>
<li><strong>location</strong>: University location in (city, country) format</li>
<li><strong>lat</strong> and <strong>long</strong>: Latitude and longitude of the university’s city</li>
</ul>
</div>
<p>The variables <code>rank</code>, <code>name</code>, <code>country</code>, <code>city</code>, <code>enrollment</code>, <code>score</code>, and <code>abstract</code> are sourced directly from the U.S. News website. Among these, <code>score</code>, <code>enrollment</code>, <code>numeric_rank</code>, <code>year_founded</code>, <code>lat</code>, and <code>long</code> are numeric, while <code>rank</code>, <code>name</code>, <code>country</code>, <code>city</code>, <code>abstract</code>, and <code>location</code> are categorical.</p>
<p>The original <code>rank</code> and <code>abstract</code> variables have been retained for potential use in Shiny outputs and further analysis. Additionally, the <code>lat</code> and <code>long</code> variables provide geographic coordinates for mapping purposes.</p>
<p>The university ranking system is an important platform for students and their parents to choose their desired university by comparing its strengths and weaknesses. With complete information, such as location, rank, and enrollment, families can make an optimal decision based on economic status, cultural influence, and academic fit. Research demonstrates that university rankings provide more relevant information for prospective students, particularly regarding quality dimensions like mentoring, faculty infrastructure, and overall satisfaction, rather than research reputation (Horstschräer, 2012). Therefore, investigating global university rankings and their relationship with other information holds significant social value, helping society better understand the implications of a university’s rank. In this study, data on the top 200 universities, demonstrating strong performance, are explicitly analyzed and interpreted.</p>
</section>
<section id="part-ii-a-building-an-interactive-dashborad-with-r-shiny" class="level2">
<h2 class="anchored" data-anchor-id="part-ii-a-building-an-interactive-dashborad-with-r-shiny">Part II A-Building an Interactive Dashborad with R Shiny</h2>
<p>In this study, three visualizations are created to understand the global university rankings. The first visualization compares the overall score and enrollment size. In the UI section, users can select the country (All – Turkey) and the rank range (#1 - #199), with enrollment as the x-coordinate and score as the y-coordinate. The color represents different countries, and a larger spot signifies a higher-ranked university. Among the top 50 global universities, Harvard, MIT, and Stanford are outliers with scores of 100.0, 96.9, and 94.5, respectively. The mean and median of the overall scores for the top 200 universities are 73.06 and 71.90, indicating that the distribution of scores is right-skewed due to universities like the three mentioned above. The distribution of enrollment is also right-skewed, with a mean of 32,269 and a median of 32,078. There is a slight positive correlation between scores and enrollment, suggesting that a top 200 university with more students is likely to be considered more prestigious. However, this relationship does not hold at the country level, as some countries either lack sufficient universities to show a trend or exhibit a flat relationship between the two variables, warranting further statistical analysis like linear regression analysis.</p>
<p>The second output explores the relationships between the year founded, rank, and enrollment using two scatter plots. The founding year ranges from 1088 to 1968, with a mean of 1772 and a median of 1853, showing a left-skewed distribution, influenced by low outliers. A slight positive correlation is found between the score and the year founded, with newly founded universities tending to have higher scores. Similarly, the graph shows a positive relationship between the year founded and enrollment, although the correlation is relatively small. Based on these trends, it is likely that universities with a longer history recruit fewer students and are considered less competitive in terms of scores.</p>
<p>The final output shows the geographical distribution of universities using the OSM method. Based on the map, it is clear that the top 200 universities are mostly clustered in the United States, central and northern Europe, China, and Australia. Regarding the distribution of the top 50 universities, most are located in the United States, particularly along the West and East Coasts, as well as in central and northern Europe, reflecting their dominant academic environments and histories as developed Western countries. Additionally, China, one of the leading developing countries, exhibits a strong academic culture, with more universities in the top 200 list than any other developing country. A previous study argued that U.S. economic success can be attributed to a well-educated labor force, noting that the London-based Times Higher Education’s 2009 list of the top 10 universities included six American universities, while China still had a long way to go (Nye Jr., 2010). Fifteen years later, the trend remains persistent, though Chinese universities have significantly improved, laying a strong foundation for the labor force. &nbsp;&nbsp;&nbsp;&nbsp;</p>
<p>The report has adequately demonstrated the dominant academic performance in Western countries, while developing countries like China have also caught up in pace. Newly founded universities show strong and competitive academic performance in terms of rankings and large student enrollments, which diverges from that of historic universities. The quantitative benefits and graduate outcomes should be studied more specifically in the future to understand the rationale behind the two distinct strategies.</p>
</section>
<section id="part-ii-c-critical-engagement-with-ai-chat-gpt" class="level2">
<h2 class="anchored" data-anchor-id="part-ii-c-critical-engagement-with-ai-chat-gpt">Part II C-Critical Engagement with AI: Chat GPT</h2>
<p>This study actively engaged with Chat GPT AI for code refinement and language fluidity. Originally, the code for handling the “Load More” button clicked the button directly, but Chat GPT suggested using the <code>tryCatch</code> function to prevent breaking the loop if it fails to catch and to add a sentence after clicking to indicate whether the action was successful. Additionally, though I was aware of it, Chat GPT helped confirm the correct code and split the score and enrollment data using <code>sequence</code> and <code>by</code>. During data wrangling, it used <code>\\d{4}</code> to extract the four-digit year-founded data and clarified the geocode function to obtain geographical coordinates. For the Shiny app design, Chat GPT helped set the height parameter to enlarge the plot and map for better visibility. It also avoided label overlaps and reversed the dot size scale by using <code>ggrepel</code> and <code>scale_size_continuous</code>. In the map output, Chat GPT assisted in adding information for overlapping points on the map. Finally, it helped fit the tab panel.</p>
<p>However, issues still arose during engagement with Chat GPT, including mismatched methods between its suggestions and the lecture methods. Sometimes, the methods Chat GPT provided were overly complicated or advanced and not applicable to the study. As a result, it was time-consuming to adjust them to an appropriate level. On the other hand, this presented an opportunity to learn new methods and theoretical concepts, which can benefit the user by introducing new techniques that can be adopted in the future.</p>
</section>
<section id="reference-list" class="level2">
<h2 class="anchored" data-anchor-id="reference-list">Reference List</h2>
<p>Horstschräer, J. (2012). University rankings in action? The importance of rankings and an excellence competition for university choice of high-ability students. <em>Economics of Education Review, 31</em>(6), 1162–1176. https://doi.org/10.1016/j.econedurev.2012.07.018</p>
<p>Nye, J. S., Jr.&nbsp;(2010). The futures of American power: Dominance and decline in perspective. <em>Foreign Affairs, 89</em>(6), 2–12.</p>
<!-- -->

</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb1" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "U.S. News University Ranking"</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="an">editor:</span><span class="co"> visual</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-depth: 2</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-location: left</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co">  revealjs: </span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co">    theme: [simple, custom.scss]</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: Preparation</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Empty your environment by removing all objects</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Setup: Install and load necessary packages for web scraping, data manipulation, and visualization</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">"pacman"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) <span class="fu">install.packages</span>(<span class="st">"pacman"</span>)</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>  RSelenium,  <span class="co"># For interacting with a web browser</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>  rvest,      <span class="co"># For web scraping</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>  purrr,      <span class="co"># For functional programming</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>  dplyr,      <span class="co"># For data manipulation</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>  ggplot2,    <span class="co"># For data visualization</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>  plotly,     <span class="co"># For interactive plots</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>  countrycode, <span class="co"># For country code conversions</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>  shiny,      <span class="co"># For building interactive apps</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>  stringr,    <span class="co"># For string manipulation</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>  ggrepel,    <span class="co"># For improved text placement in ggplot2</span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>  leaflet,    <span class="co"># For mapping</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>  tidygeocoder <span class="co"># For geocoding</span></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part I-A Automated Data Collection</span></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: Web Scrape</span></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a><span class="co"># Connecting to the Firefox browser via RSelenium</span></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>driver <span class="ot">&lt;-</span> <span class="fu">rsDriver</span>(<span class="at">browser =</span> <span class="st">"firefox"</span>)  <span class="co"># Specify Firefox browser</span></span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>remote_driver <span class="ot">&lt;-</span> driver<span class="sc">$</span>client</span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a><span class="co"># Navigating to the target URL to fetch the university rankings</span></span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="st">"https://www.usnews.com/education/best-global-universities/rankings"</span></span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>remote_driver<span class="sc">$</span><span class="fu">navigate</span>(url)</span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a><span class="co"># Handle cookie consent pop-up by clicking the consent button</span></span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>webElems <span class="ot">&lt;-</span> remote_driver<span class="sc">$</span><span class="fu">findElements</span>(<span class="at">using =</span> <span class="st">"id"</span>, <span class="st">'onetrust-accept-btn-handler'</span>)</span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>webElems[[<span class="dv">1</span>]]<span class="sc">$</span><span class="fu">clickElement</span>()</span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.sleep</span>(<span class="dv">2</span>)  <span class="co"># Wait for the page to load</span></span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a function to scroll the page and click "Load More" button to reveal more rankings</span></span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>scroll_and_load <span class="ot">&lt;-</span> <span class="cf">function</span>(i) {</span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Cycle"</span>, i, <span class="st">"of"</span>, <span class="dv">25</span>, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Scroll down the page to load more content</span></span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>  remote_driver<span class="sc">$</span><span class="fu">executeScript</span>(<span class="st">'window.scrollTo(0, document.body.scrollHeight * 0.8);'</span>)</span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(<span class="dv">5</span>)</span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Attempt to click the "Load More" button</span></span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tryCatch</span>({</span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a>    load_button <span class="ot">&lt;-</span> remote_driver<span class="sc">$</span><span class="fu">findElement</span>(<span class="at">using =</span> <span class="st">"xpath"</span>, <span class="st">'//button[@rel="next"]//span'</span>)</span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a>    load_button<span class="sc">$</span><span class="fu">clickElement</span>()</span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Load More button found. Clicking...</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Sys.sleep</span>(<span class="dv">5</span>)</span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"No more 'Load More' button found. Exiting...</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the map function to iterate over 25 cycles of scrolling and clicking the "Load More" button</span></span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a><span class="fu">map</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>, scroll_and_load)</span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the necessary data elements from the webpage</span></span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a>name <span class="ot">&lt;-</span> remote_driver<span class="sc">$</span><span class="fu">findElements</span>(<span class="at">using =</span> <span class="st">"xpath"</span>, <span class="st">'//h2[@class="Heading-sc-1w5xk2o-0 erfdut md-mb2"]'</span>)</span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a>country <span class="ot">&lt;-</span> remote_driver<span class="sc">$</span><span class="fu">findElements</span>(<span class="at">using =</span> <span class="st">"xpath"</span>, <span class="st">'//p[@class="Paragraph-sc-1iyax29-0 fbFZrE"]/span[1]'</span>)</span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a>city <span class="ot">&lt;-</span> remote_driver<span class="sc">$</span><span class="fu">findElements</span>(<span class="at">using =</span> <span class="st">"xpath"</span>, <span class="st">'//p[@class="Paragraph-sc-1iyax29-0 fbFZrE"]/span[3]'</span>)</span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a>rank <span class="ot">&lt;-</span> remote_driver<span class="sc">$</span><span class="fu">findElements</span>(<span class="at">using =</span> <span class="st">"xpath"</span>, <span class="st">'//div[@class="RankList__Rank-sc-2xewen-2 ieuiBj ranked has-badge"]//strong'</span>)</span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a>score_Enrollment <span class="ot">&lt;-</span> remote_driver<span class="sc">$</span><span class="fu">findElements</span>(<span class="at">using =</span> <span class="st">"xpath"</span>, <span class="st">'//div[@class="Box-w0dun1-0 QuickStatHug__Container-hb1bl8-0 bcZeaE fkvuin QuickStatHug-hb1bl8-2 fyaies QuickStatHug-hb1bl8-2 fyaies"]//dd[1]'</span>)</span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a>abstract <span class="ot">&lt;-</span> remote_driver<span class="sc">$</span><span class="fu">findElements</span>(<span class="at">using =</span> <span class="st">"xpath"</span>, <span class="st">'//p[@class="Paragraph-sc-1iyax29-0 fBaaRL sm-hide"]'</span>)</span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract scores and enrollment details, handling alternate data elements</span></span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a>score_Enrollment <span class="ot">&lt;-</span> <span class="fu">sapply</span>(score_Enrollment, <span class="cf">function</span>(x) x<span class="sc">$</span><span class="fu">getElementText</span>()[[<span class="dv">1</span>]])</span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a>score <span class="ot">&lt;-</span> score_Enrollment[<span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">length</span>(score_Enrollment), <span class="at">by =</span> <span class="dv">2</span>)]  <span class="co"># Odd indices for scores</span></span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true" tabindex="-1"></a>enrollment <span class="ot">&lt;-</span> score_Enrollment[<span class="fu">seq</span>(<span class="dv">2</span>, <span class="fu">length</span>(score_Enrollment), <span class="at">by =</span> <span class="dv">2</span>)]  <span class="co"># Even indices for enrollment numbers</span></span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a tibble (data frame) to store the extracted information</span></span>
<span id="cb1-105"><a href="#cb1-105" aria-hidden="true" tabindex="-1"></a>usNews_ranking <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb1-106"><a href="#cb1-106" aria-hidden="true" tabindex="-1"></a>  <span class="at">rank =</span> <span class="fu">sapply</span>(rank, <span class="cf">function</span>(x) x<span class="sc">$</span><span class="fu">getElementText</span>()[[<span class="dv">1</span>]]),</span>
<span id="cb1-107"><a href="#cb1-107" aria-hidden="true" tabindex="-1"></a>  <span class="at">university =</span> <span class="fu">sapply</span>(name, <span class="cf">function</span>(x) x<span class="sc">$</span><span class="fu">getElementText</span>()[[<span class="dv">1</span>]]),</span>
<span id="cb1-108"><a href="#cb1-108" aria-hidden="true" tabindex="-1"></a>  <span class="at">country =</span> <span class="fu">sapply</span>(country, <span class="cf">function</span>(x) x<span class="sc">$</span><span class="fu">getElementText</span>()[[<span class="dv">1</span>]]),</span>
<span id="cb1-109"><a href="#cb1-109" aria-hidden="true" tabindex="-1"></a>  <span class="at">city =</span> <span class="fu">sapply</span>(city, <span class="cf">function</span>(x) x<span class="sc">$</span><span class="fu">getElementText</span>()[[<span class="dv">1</span>]]),</span>
<span id="cb1-110"><a href="#cb1-110" aria-hidden="true" tabindex="-1"></a>  <span class="at">enrollment =</span> enrollment,</span>
<span id="cb1-111"><a href="#cb1-111" aria-hidden="true" tabindex="-1"></a>  <span class="at">score =</span> score,</span>
<span id="cb1-112"><a href="#cb1-112" aria-hidden="true" tabindex="-1"></a>  <span class="at">abstract =</span> <span class="fu">sapply</span>(abstract, <span class="cf">function</span>(x) x<span class="sc">$</span><span class="fu">getElementText</span>()[[<span class="dv">1</span>]])</span>
<span id="cb1-113"><a href="#cb1-113" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-114"><a href="#cb1-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-115"><a href="#cb1-115" aria-hidden="true" tabindex="-1"></a><span class="co">#remote_driver$close()  # Close the remote driver</span></span>
<span id="cb1-116"><a href="#cb1-116" aria-hidden="true" tabindex="-1"></a><span class="co">#driver$server$stop()  # Stop the Selenium server</span></span>
<span id="cb1-117"><a href="#cb1-117" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-118"><a href="#cb1-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-119"><a href="#cb1-119" aria-hidden="true" tabindex="-1"></a>This study adopts a dynamic web-scraping method to explore the significance of university rankings through the U.S. News website, as API is not available. Using the Firefox browser, a remote driver object is created. Then, the <span class="in">`navigate`</span> function from the RSelenium package directs the browser to the webpage using the assigned URL for the 2024-2025 global university ranking by U.S. News. Since the website requires users to accept or reject cookies, the accept button element is located by inspecting its ID, and the button is subsequently clicked using the Selenium package.</span>
<span id="cb1-120"><a href="#cb1-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-121"><a href="#cb1-121" aria-hidden="true" tabindex="-1"></a>Now, the ranking data can be scraped. The webpage includes the following information: the names of universities, ranks, locations, overall scores, and enrollment numbers. For certain universities, such as Harvard and MIT, a short abstract is also included, requiring a click on “Read More” to display the full message. Using the <span class="in">`findElement`</span> function, the XPaths of elements such as name, rank, and abstract are identified to enable R to extract all the university information. By inspecting the class attribute of the HTML structure, R is able to fetch all the data associated with the class, such as <span class="in">`h2`</span> for university names and <span class="in">`p`</span> for abstracts.</span>
<span id="cb1-122"><a href="#cb1-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-123"><a href="#cb1-123" aria-hidden="true" tabindex="-1"></a>The website requires scrolling down to load all universities, and a specific “Load More” button, located near the bottom of the webpage (but not exactly at the bottom), needs to be clicked after a certain number of scrolls. The number of scrolls required appears to vary. To handle this, a JavaScript function <span class="in">`executeScript`</span> is adopted to scroll the window to 80% of the page height, ensuring the “Load More” button is visible. This approach is derived from the YouTube tutorial referenced in the Week 6 lecture slides. To handle potential errors, such as when the “Load More” button fails to appear, a <span class="in">`tryCatch`</span> function is employed. This function prints a success reminder if the button is successfully located and clicked or provides a failure message to inform the user otherwise.</span>
<span id="cb1-124"><a href="#cb1-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-125"><a href="#cb1-125" aria-hidden="true" tabindex="-1"></a>To scrape the maximum amount of data, a loop function is implemented to repeat the scrolling and loading process 25 times, which access sufficient data without over-loading the website. After completing 25 iterations, a substantial amount of university information is loaded onto the webpage, which can then be scraped using the identified XPaths as discussed earlier. Information from 220 universities is subsequently gathered. However, during multiple tests, the scrolling is still unstable in locating the button, as the location of the button varies, requiring adjustment in future study.</span>
<span id="cb1-126"><a href="#cb1-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-127"><a href="#cb1-127" aria-hidden="true" tabindex="-1"></a>As the collected data is in web element type, it must be transformed into text to create a table. A table, <span class="in">`usNews_ranking`</span>, is created using the <span class="in">`tibble`</span> function, which allows for flexible manipulation of columns. The rank data is transformed into text using both the <span class="in">`sapply`</span> and <span class="in">`getElementText`</span> functions, and the same method is applied to the remaining columns. Consequently, a table with nine variables and 220 observations is constructed.</span>
<span id="cb1-128"><a href="#cb1-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-131"><a href="#cb1-131" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb1-132"><a href="#cb1-132" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: Data Wrangling</span></span>
<span id="cb1-133"><a href="#cb1-133" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb1-134"><a href="#cb1-134" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb1-135"><a href="#cb1-135" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb1-136"><a href="#cb1-136" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb1-137"><a href="#cb1-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-138"><a href="#cb1-138" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean and process enrollment data</span></span>
<span id="cb1-139"><a href="#cb1-139" aria-hidden="true" tabindex="-1"></a>usNews_ranking<span class="sc">$</span>enrollment[usNews_ranking<span class="sc">$</span>enrollment <span class="sc">==</span> <span class="st">"N/A"</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span>  <span class="co"># Replace "N/A" with NA</span></span>
<span id="cb1-140"><a href="#cb1-140" aria-hidden="true" tabindex="-1"></a>usNews_ranking<span class="sc">$</span>enrollment <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">","</span>, <span class="st">""</span>, usNews_ranking<span class="sc">$</span>enrollment)  <span class="co"># Remove commas in enrollment numbers</span></span>
<span id="cb1-141"><a href="#cb1-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-142"><a href="#cb1-142" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean the data: Convert character columns to appropriate data types</span></span>
<span id="cb1-143"><a href="#cb1-143" aria-hidden="true" tabindex="-1"></a>usNews_ranking <span class="ot">&lt;-</span> usNews_ranking <span class="sc">%&gt;%</span></span>
<span id="cb1-144"><a href="#cb1-144" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb1-145"><a href="#cb1-145" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_all</span>(<span class="sc">~</span> <span class="fu">ifelse</span>(. <span class="sc">==</span> <span class="st">""</span>, <span class="cn">NA</span>, .)) <span class="sc">%&gt;%</span>  <span class="co"># Replace empty strings with NA</span></span>
<span id="cb1-146"><a href="#cb1-146" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb1-147"><a href="#cb1-147" aria-hidden="true" tabindex="-1"></a>    <span class="at">numeric_rank =</span> <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">"#"</span>, <span class="st">""</span>, rank)),  <span class="co"># Convert rank to numeric (remove "#" symbol)</span></span>
<span id="cb1-148"><a href="#cb1-148" aria-hidden="true" tabindex="-1"></a>    <span class="at">score =</span> <span class="fu">as.numeric</span>(score),  <span class="co"># Convert score to numeric</span></span>
<span id="cb1-149"><a href="#cb1-149" aria-hidden="true" tabindex="-1"></a>    <span class="at">enrollment =</span> <span class="fu">as.numeric</span>(enrollment),  <span class="co"># Convert enrollment to numeric</span></span>
<span id="cb1-150"><a href="#cb1-150" aria-hidden="true" tabindex="-1"></a>    <span class="at">year_founded =</span> <span class="fu">as.numeric</span>(<span class="fu">str_extract</span>(abstract, <span class="st">"</span><span class="sc">\\</span><span class="st">d{4}"</span>))  <span class="co"># Extract and convert year founded</span></span>
<span id="cb1-151"><a href="#cb1-151" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb1-152"><a href="#cb1-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-153"><a href="#cb1-153" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove text within brackets (including brackets) from the 'city' column</span></span>
<span id="cb1-154"><a href="#cb1-154" aria-hidden="true" tabindex="-1"></a><span class="co"># The regular expression matches text inside parentheses and removes it</span></span>
<span id="cb1-155"><a href="#cb1-155" aria-hidden="true" tabindex="-1"></a>usNews_ranking<span class="sc">$</span>city <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">s*</span><span class="sc">\\</span><span class="st">(.*?</span><span class="sc">\\</span><span class="st">)"</span>, <span class="st">""</span>, usNews_ranking<span class="sc">$</span>city)</span>
<span id="cb1-156"><a href="#cb1-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-157"><a href="#cb1-157" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove the last 20 rows from the dataset (if necessary to remove incomplete data)</span></span>
<span id="cb1-158"><a href="#cb1-158" aria-hidden="true" tabindex="-1"></a>usNews_ranking <span class="ot">&lt;-</span> usNews_ranking[<span class="dv">1</span><span class="sc">:</span>(<span class="fu">length</span>(usNews_ranking<span class="sc">$</span>rank) <span class="sc">-</span> <span class="dv">20</span>), ]</span>
<span id="cb1-159"><a href="#cb1-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-160"><a href="#cb1-160" aria-hidden="true" tabindex="-1"></a><span class="co"># Geocode location to get latitude and longitude for each university</span></span>
<span id="cb1-161"><a href="#cb1-161" aria-hidden="true" tabindex="-1"></a>usNews_ranking <span class="ot">&lt;-</span> usNews_ranking <span class="sc">%&gt;%</span></span>
<span id="cb1-162"><a href="#cb1-162" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">location =</span> <span class="fu">paste</span>(city, <span class="st">","</span>, country))  <span class="co"># Combine city and country to create a location field</span></span>
<span id="cb1-163"><a href="#cb1-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-164"><a href="#cb1-164" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform geocoding using OpenStreetMap (osm) to obtain coordinates for each location</span></span>
<span id="cb1-165"><a href="#cb1-165" aria-hidden="true" tabindex="-1"></a>geo_data <span class="ot">&lt;-</span> usNews_ranking <span class="sc">%&gt;%</span></span>
<span id="cb1-166"><a href="#cb1-166" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(location) <span class="sc">%&gt;%</span></span>
<span id="cb1-167"><a href="#cb1-167" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geocode</span>(location, <span class="at">method =</span> <span class="st">"osm"</span>)</span>
<span id="cb1-168"><a href="#cb1-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-169"><a href="#cb1-169" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge geocode data back into the main dataset to add latitude and longitude information</span></span>
<span id="cb1-170"><a href="#cb1-170" aria-hidden="true" tabindex="-1"></a>usNews_ranking <span class="ot">&lt;-</span> usNews_ranking <span class="sc">%&gt;%</span></span>
<span id="cb1-171"><a href="#cb1-171" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(geo_data, <span class="at">by =</span> <span class="st">"location"</span>)</span>
<span id="cb1-172"><a href="#cb1-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-173"><a href="#cb1-173" aria-hidden="true" tabindex="-1"></a><span class="co"># Display a summary of the final dataset</span></span>
<span id="cb1-174"><a href="#cb1-174" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(usNews_ranking)</span>
<span id="cb1-175"><a href="#cb1-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-176"><a href="#cb1-176" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the cleaned data to a CSV file for later use</span></span>
<span id="cb1-177"><a href="#cb1-177" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(usNews_ranking, <span class="st">"usNews_ranking.csv"</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-178"><a href="#cb1-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-179"><a href="#cb1-179" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-180"><a href="#cb1-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-181"><a href="#cb1-181" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part I B-Data Exploration and Contextualisation</span></span>
<span id="cb1-182"><a href="#cb1-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-183"><a href="#cb1-183" aria-hidden="true" tabindex="-1"></a>The table is first converted to a data frame using the <span class="in">`as.data.frame`</span> function, and variables such as rank, score, and year founded are treated as numeric. Specifically, the “#” symbol is removed to create the numeric rank data, and the year founded is extracted by identifying four-digit numbers within the abstract text. Missing values are assigned for any blank spaces, and the last 20 rows of the dataset are removed to create a table containing 200 universities for a clearer view of highest-quality instituions. Using the <span class="in">`mutate`</span> function, a location variable is created by combining the city and country columns. Latitude and longitude coordinates for each university's location are added using a geocoding function with the OpenStreetMap (OSM) method. Finally, the dataset is saved as a CSV file to ensure reproducibility and further analysis.</span>
<span id="cb1-184"><a href="#cb1-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-185"><a href="#cb1-185" aria-hidden="true" tabindex="-1"></a>The <span class="in">`usNews_ranking`</span> dataset contains 12 variables, each providing specific information about universities. Notably:</span>
<span id="cb1-186"><a href="#cb1-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-187"><a href="#cb1-187" aria-hidden="true" tabindex="-1"></a>::: nonincremental</span>
<span id="cb1-188"><a href="#cb1-188" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**rank**: University rank (#)</span>
<span id="cb1-189"><a href="#cb1-189" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**name**: University name</span>
<span id="cb1-190"><a href="#cb1-190" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**country**: Country of the university</span>
<span id="cb1-191"><a href="#cb1-191" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**city**: City of the university</span>
<span id="cb1-192"><a href="#cb1-192" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**enrollment**: Number of students enrolled</span>
<span id="cb1-193"><a href="#cb1-193" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**score**: Overall score assigned by U.S. News</span>
<span id="cb1-194"><a href="#cb1-194" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**abstract**: A brief introduction to the university</span>
<span id="cb1-195"><a href="#cb1-195" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**numeric_rank**: Numeric representation of the university's rank</span>
<span id="cb1-196"><a href="#cb1-196" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**year_founded**: Year the university was established</span>
<span id="cb1-197"><a href="#cb1-197" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**location**: University location in (city, country) format</span>
<span id="cb1-198"><a href="#cb1-198" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**lat** and **long**: Latitude and longitude of the university's city</span>
<span id="cb1-199"><a href="#cb1-199" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb1-200"><a href="#cb1-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-201"><a href="#cb1-201" aria-hidden="true" tabindex="-1"></a>The variables <span class="in">`rank`</span>, <span class="in">`name`</span>, <span class="in">`country`</span>, <span class="in">`city`</span>, <span class="in">`enrollment`</span>, <span class="in">`score`</span>, and <span class="in">`abstract`</span> are sourced directly from the U.S. News website. Among these, <span class="in">`score`</span>, <span class="in">`enrollment`</span>, <span class="in">`numeric_rank`</span>, <span class="in">`year_founded`</span>, <span class="in">`lat`</span>, and <span class="in">`long`</span> are numeric, while <span class="in">`rank`</span>, <span class="in">`name`</span>, <span class="in">`country`</span>, <span class="in">`city`</span>, <span class="in">`abstract`</span>, and <span class="in">`location`</span> are categorical.</span>
<span id="cb1-202"><a href="#cb1-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-203"><a href="#cb1-203" aria-hidden="true" tabindex="-1"></a>The original <span class="in">`rank`</span> and <span class="in">`abstract`</span> variables have been retained for potential use in Shiny outputs and further analysis. Additionally, the <span class="in">`lat`</span> and <span class="in">`long`</span> variables provide geographic coordinates for mapping purposes.</span>
<span id="cb1-204"><a href="#cb1-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-205"><a href="#cb1-205" aria-hidden="true" tabindex="-1"></a>The university ranking system is an important platform for students and their parents to choose their desired university by comparing its strengths and weaknesses. With complete information, such as location, rank, and enrollment, families can make an optimal decision based on economic status, cultural influence, and academic fit. Research demonstrates that university rankings provide more relevant information for prospective students, particularly regarding quality dimensions like mentoring, faculty infrastructure, and overall satisfaction, rather than research reputation (Horstschräer, 2012). Therefore, investigating global university rankings and their relationship with other information holds significant social value, helping society better understand the implications of a university's rank. In this study, data on the top 200 universities, demonstrating strong performance, are explicitly analyzed and interpreted.</span>
<span id="cb1-206"><a href="#cb1-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-209"><a href="#cb1-209" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb1-210"><a href="#cb1-210" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: Shiny App</span></span>
<span id="cb1-211"><a href="#cb1-211" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb1-212"><a href="#cb1-212" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb1-213"><a href="#cb1-213" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb1-214"><a href="#cb1-214" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb1-215"><a href="#cb1-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-216"><a href="#cb1-216" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(shiny)</span>
<span id="cb1-217"><a href="#cb1-217" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-218"><a href="#cb1-218" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-219"><a href="#cb1-219" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaflet)</span>
<span id="cb1-220"><a href="#cb1-220" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb1-221"><a href="#cb1-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-222"><a href="#cb1-222" aria-hidden="true" tabindex="-1"></a><span class="co"># Load dataset</span></span>
<span id="cb1-223"><a href="#cb1-223" aria-hidden="true" tabindex="-1"></a>usNews_ranking <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"usNews_ranking.csv"</span>)</span>
<span id="cb1-224"><a href="#cb1-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-225"><a href="#cb1-225" aria-hidden="true" tabindex="-1"></a><span class="co"># UI</span></span>
<span id="cb1-226"><a href="#cb1-226" aria-hidden="true" tabindex="-1"></a>ui <span class="ot">&lt;-</span> <span class="fu">fluidPage</span>(</span>
<span id="cb1-227"><a href="#cb1-227" aria-hidden="true" tabindex="-1"></a>  <span class="fu">h1</span>(<span class="st">"University Ranking Dashboard"</span>),</span>
<span id="cb1-228"><a href="#cb1-228" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-229"><a href="#cb1-229" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabsetPanel</span>(</span>
<span id="cb1-230"><a href="#cb1-230" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Tab 1: Scatter Plot</span></span>
<span id="cb1-231"><a href="#cb1-231" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tabPanel</span>(<span class="st">"Score vs Enrollment"</span>,</span>
<span id="cb1-232"><a href="#cb1-232" aria-hidden="true" tabindex="-1"></a>             <span class="fu">sidebarLayout</span>(</span>
<span id="cb1-233"><a href="#cb1-233" aria-hidden="true" tabindex="-1"></a>               <span class="fu">sidebarPanel</span>(</span>
<span id="cb1-234"><a href="#cb1-234" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">selectInput</span>(</span>
<span id="cb1-235"><a href="#cb1-235" aria-hidden="true" tabindex="-1"></a>                   <span class="at">inputId =</span> <span class="st">"country"</span>,</span>
<span id="cb1-236"><a href="#cb1-236" aria-hidden="true" tabindex="-1"></a>                   <span class="at">label =</span> <span class="st">"Select Country"</span>,</span>
<span id="cb1-237"><a href="#cb1-237" aria-hidden="true" tabindex="-1"></a>                   <span class="at">choices =</span> <span class="fu">c</span>(<span class="st">"All"</span>, <span class="fu">unique</span>(usNews_ranking<span class="sc">$</span>country)),</span>
<span id="cb1-238"><a href="#cb1-238" aria-hidden="true" tabindex="-1"></a>                   <span class="at">selected =</span> <span class="st">"All"</span></span>
<span id="cb1-239"><a href="#cb1-239" aria-hidden="true" tabindex="-1"></a>                 ),</span>
<span id="cb1-240"><a href="#cb1-240" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">sliderInput</span>(</span>
<span id="cb1-241"><a href="#cb1-241" aria-hidden="true" tabindex="-1"></a>                   <span class="at">inputId =</span> <span class="st">"rank_range"</span>,</span>
<span id="cb1-242"><a href="#cb1-242" aria-hidden="true" tabindex="-1"></a>                   <span class="at">label =</span> <span class="st">"Select Rank Range"</span>,</span>
<span id="cb1-243"><a href="#cb1-243" aria-hidden="true" tabindex="-1"></a>                   <span class="at">min =</span> <span class="fu">min</span>(usNews_ranking<span class="sc">$</span>numeric_rank),</span>
<span id="cb1-244"><a href="#cb1-244" aria-hidden="true" tabindex="-1"></a>                   <span class="at">max =</span> <span class="fu">max</span>(usNews_ranking<span class="sc">$</span>numeric_rank),</span>
<span id="cb1-245"><a href="#cb1-245" aria-hidden="true" tabindex="-1"></a>                   <span class="at">value =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">30</span>),</span>
<span id="cb1-246"><a href="#cb1-246" aria-hidden="true" tabindex="-1"></a>                   <span class="at">step =</span> <span class="dv">1</span></span>
<span id="cb1-247"><a href="#cb1-247" aria-hidden="true" tabindex="-1"></a>                 )</span>
<span id="cb1-248"><a href="#cb1-248" aria-hidden="true" tabindex="-1"></a>               ),</span>
<span id="cb1-249"><a href="#cb1-249" aria-hidden="true" tabindex="-1"></a>               <span class="fu">mainPanel</span>(</span>
<span id="cb1-250"><a href="#cb1-250" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">plotOutput</span>(<span class="st">"scatter_plot"</span>,<span class="at">height =</span> <span class="st">"700px"</span>) <span class="co"># Amplify the graph</span></span>
<span id="cb1-251"><a href="#cb1-251" aria-hidden="true" tabindex="-1"></a>               )</span>
<span id="cb1-252"><a href="#cb1-252" aria-hidden="true" tabindex="-1"></a>             )</span>
<span id="cb1-253"><a href="#cb1-253" aria-hidden="true" tabindex="-1"></a>            ),</span>
<span id="cb1-254"><a href="#cb1-254" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-255"><a href="#cb1-255" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Tab 2: Year Founded Plots</span></span>
<span id="cb1-256"><a href="#cb1-256" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tabPanel</span>(<span class="st">"Year Founded Analysis"</span>,</span>
<span id="cb1-257"><a href="#cb1-257" aria-hidden="true" tabindex="-1"></a>             <span class="fu">sidebarLayout</span>(</span>
<span id="cb1-258"><a href="#cb1-258" aria-hidden="true" tabindex="-1"></a>               <span class="fu">sidebarPanel</span>(</span>
<span id="cb1-259"><a href="#cb1-259" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">selectInput</span>(</span>
<span id="cb1-260"><a href="#cb1-260" aria-hidden="true" tabindex="-1"></a>                   <span class="at">inputId =</span> <span class="st">"country"</span>,</span>
<span id="cb1-261"><a href="#cb1-261" aria-hidden="true" tabindex="-1"></a>                   <span class="at">label =</span> <span class="st">"Select Country"</span>,</span>
<span id="cb1-262"><a href="#cb1-262" aria-hidden="true" tabindex="-1"></a>                   <span class="at">choices =</span> <span class="fu">c</span>(<span class="st">"All"</span>, <span class="fu">unique</span>(usNews_ranking<span class="sc">$</span>country)),</span>
<span id="cb1-263"><a href="#cb1-263" aria-hidden="true" tabindex="-1"></a>                   <span class="at">selected =</span> <span class="st">"All"</span></span>
<span id="cb1-264"><a href="#cb1-264" aria-hidden="true" tabindex="-1"></a>                 ),</span>
<span id="cb1-265"><a href="#cb1-265" aria-hidden="true" tabindex="-1"></a>                 </span>
<span id="cb1-266"><a href="#cb1-266" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">sliderInput</span>(</span>
<span id="cb1-267"><a href="#cb1-267" aria-hidden="true" tabindex="-1"></a>                   <span class="at">inputId =</span> <span class="st">"rank_range"</span>,</span>
<span id="cb1-268"><a href="#cb1-268" aria-hidden="true" tabindex="-1"></a>                   <span class="at">label =</span> <span class="st">"Select Rank Range"</span>,</span>
<span id="cb1-269"><a href="#cb1-269" aria-hidden="true" tabindex="-1"></a>                   <span class="at">min =</span> <span class="fu">min</span>(usNews_ranking<span class="sc">$</span>numeric_rank),</span>
<span id="cb1-270"><a href="#cb1-270" aria-hidden="true" tabindex="-1"></a>                   <span class="at">max =</span> <span class="fu">max</span>(usNews_ranking<span class="sc">$</span>numeric_rank),</span>
<span id="cb1-271"><a href="#cb1-271" aria-hidden="true" tabindex="-1"></a>                   <span class="at">value =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">30</span>),</span>
<span id="cb1-272"><a href="#cb1-272" aria-hidden="true" tabindex="-1"></a>                   <span class="at">step =</span> <span class="dv">1</span></span>
<span id="cb1-273"><a href="#cb1-273" aria-hidden="true" tabindex="-1"></a>                 )</span>
<span id="cb1-274"><a href="#cb1-274" aria-hidden="true" tabindex="-1"></a>               ),</span>
<span id="cb1-275"><a href="#cb1-275" aria-hidden="true" tabindex="-1"></a>               <span class="fu">mainPanel</span>(</span>
<span id="cb1-276"><a href="#cb1-276" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">plotOutput</span>(<span class="st">"year_rank_plot"</span>),</span>
<span id="cb1-277"><a href="#cb1-277" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">plotOutput</span>(<span class="st">"year_score_plot"</span>)</span>
<span id="cb1-278"><a href="#cb1-278" aria-hidden="true" tabindex="-1"></a>               )</span>
<span id="cb1-279"><a href="#cb1-279" aria-hidden="true" tabindex="-1"></a>             )),</span>
<span id="cb1-280"><a href="#cb1-280" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-281"><a href="#cb1-281" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Tab 3: Map View</span></span>
<span id="cb1-282"><a href="#cb1-282" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tabPanel</span>(<span class="st">"Map View"</span>,</span>
<span id="cb1-283"><a href="#cb1-283" aria-hidden="true" tabindex="-1"></a>             <span class="fu">sidebarLayout</span>(</span>
<span id="cb1-284"><a href="#cb1-284" aria-hidden="true" tabindex="-1"></a>               <span class="fu">sidebarPanel</span>(</span>
<span id="cb1-285"><a href="#cb1-285" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">selectInput</span>(</span>
<span id="cb1-286"><a href="#cb1-286" aria-hidden="true" tabindex="-1"></a>                   <span class="at">inputId =</span> <span class="st">"country"</span>,</span>
<span id="cb1-287"><a href="#cb1-287" aria-hidden="true" tabindex="-1"></a>                   <span class="at">label =</span> <span class="st">"Select Country"</span>,</span>
<span id="cb1-288"><a href="#cb1-288" aria-hidden="true" tabindex="-1"></a>                   <span class="at">choices =</span> <span class="fu">c</span>(<span class="st">"All"</span>, <span class="fu">unique</span>(usNews_ranking<span class="sc">$</span>country)), </span>
<span id="cb1-289"><a href="#cb1-289" aria-hidden="true" tabindex="-1"></a>                   <span class="at">selected =</span> <span class="st">"All"</span></span>
<span id="cb1-290"><a href="#cb1-290" aria-hidden="true" tabindex="-1"></a>                 ),</span>
<span id="cb1-291"><a href="#cb1-291" aria-hidden="true" tabindex="-1"></a>                 </span>
<span id="cb1-292"><a href="#cb1-292" aria-hidden="true" tabindex="-1"></a>                 <span class="co"># Region Dropdown - Automatically populated based on the selected country</span></span>
<span id="cb1-293"><a href="#cb1-293" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">selectInput</span>(</span>
<span id="cb1-294"><a href="#cb1-294" aria-hidden="true" tabindex="-1"></a>                   <span class="at">inputId =</span> <span class="st">"city"</span>,</span>
<span id="cb1-295"><a href="#cb1-295" aria-hidden="true" tabindex="-1"></a>                   <span class="at">label =</span> <span class="st">"Select City"</span>,</span>
<span id="cb1-296"><a href="#cb1-296" aria-hidden="true" tabindex="-1"></a>                   <span class="at">choices =</span> <span class="fu">c</span>(<span class="st">"All"</span>, <span class="fu">unique</span>(usNews_ranking<span class="sc">$</span>city)),</span>
<span id="cb1-297"><a href="#cb1-297" aria-hidden="true" tabindex="-1"></a>                   <span class="at">selected =</span> <span class="st">"All"</span></span>
<span id="cb1-298"><a href="#cb1-298" aria-hidden="true" tabindex="-1"></a>                 ),</span>
<span id="cb1-299"><a href="#cb1-299" aria-hidden="true" tabindex="-1"></a>                 </span>
<span id="cb1-300"><a href="#cb1-300" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">sliderInput</span>(</span>
<span id="cb1-301"><a href="#cb1-301" aria-hidden="true" tabindex="-1"></a>                   <span class="at">inputId =</span> <span class="st">"rank_range"</span>,</span>
<span id="cb1-302"><a href="#cb1-302" aria-hidden="true" tabindex="-1"></a>                   <span class="at">label =</span> <span class="st">"Select Rank Range"</span>,</span>
<span id="cb1-303"><a href="#cb1-303" aria-hidden="true" tabindex="-1"></a>                   <span class="at">min =</span> <span class="fu">min</span>(usNews_ranking<span class="sc">$</span>numeric_rank),</span>
<span id="cb1-304"><a href="#cb1-304" aria-hidden="true" tabindex="-1"></a>                   <span class="at">max =</span> <span class="fu">max</span>(usNews_ranking<span class="sc">$</span>numeric_rank),</span>
<span id="cb1-305"><a href="#cb1-305" aria-hidden="true" tabindex="-1"></a>                   <span class="at">value =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">30</span>),</span>
<span id="cb1-306"><a href="#cb1-306" aria-hidden="true" tabindex="-1"></a>                   <span class="at">step =</span> <span class="dv">1</span></span>
<span id="cb1-307"><a href="#cb1-307" aria-hidden="true" tabindex="-1"></a>                 )</span>
<span id="cb1-308"><a href="#cb1-308" aria-hidden="true" tabindex="-1"></a>               ),</span>
<span id="cb1-309"><a href="#cb1-309" aria-hidden="true" tabindex="-1"></a>               <span class="fu">mainPanel</span>(</span>
<span id="cb1-310"><a href="#cb1-310" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">leafletOutput</span>(<span class="st">"map_output"</span>,<span class="at">height =</span> <span class="st">"700px"</span>)</span>
<span id="cb1-311"><a href="#cb1-311" aria-hidden="true" tabindex="-1"></a>               )</span>
<span id="cb1-312"><a href="#cb1-312" aria-hidden="true" tabindex="-1"></a>             ))</span>
<span id="cb1-313"><a href="#cb1-313" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb1-314"><a href="#cb1-314" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-315"><a href="#cb1-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-316"><a href="#cb1-316" aria-hidden="true" tabindex="-1"></a><span class="co"># Server</span></span>
<span id="cb1-317"><a href="#cb1-317" aria-hidden="true" tabindex="-1"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output, session) {</span>
<span id="cb1-318"><a href="#cb1-318" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-319"><a href="#cb1-319" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Tab 1: Scatter Plot</span></span>
<span id="cb1-320"><a href="#cb1-320" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>scatter_plot <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>({</span>
<span id="cb1-321"><a href="#cb1-321" aria-hidden="true" tabindex="-1"></a>    filtered_data <span class="ot">&lt;-</span> usNews_ranking <span class="sc">%&gt;%</span></span>
<span id="cb1-322"><a href="#cb1-322" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>((input<span class="sc">$</span>country <span class="sc">==</span> <span class="st">"All"</span> <span class="sc">|</span> country <span class="sc">==</span> input<span class="sc">$</span>country) <span class="sc">&amp;</span></span>
<span id="cb1-323"><a href="#cb1-323" aria-hidden="true" tabindex="-1"></a>               numeric_rank <span class="sc">&gt;=</span> input<span class="sc">$</span>rank_range[<span class="dv">1</span>] <span class="sc">&amp;</span> </span>
<span id="cb1-324"><a href="#cb1-324" aria-hidden="true" tabindex="-1"></a>               numeric_rank <span class="sc">&lt;=</span> input<span class="sc">$</span>rank_range[<span class="dv">2</span>])</span>
<span id="cb1-325"><a href="#cb1-325" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-326"><a href="#cb1-326" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(filtered_data, <span class="fu">aes</span>(<span class="at">x =</span> enrollment, <span class="at">y =</span> score, <span class="at">color =</span> country, <span class="at">size =</span> numeric_rank, <span class="at">label =</span> university)) <span class="sc">+</span></span>
<span id="cb1-327"><a href="#cb1-327" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span>      </span>
<span id="cb1-328"><a href="#cb1-328" aria-hidden="true" tabindex="-1"></a>      ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(<span class="at">size =</span> <span class="fl">2.5</span>, <span class="at">max.overlaps =</span> <span class="dv">100</span>) <span class="sc">+</span>  <span class="co"># Add university names</span></span>
<span id="cb1-329"><a href="#cb1-329" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_size_continuous</span>(<span class="at">trans =</span> <span class="st">"reverse"</span>) <span class="sc">+</span>  <span class="co"># Reverse the size scale</span></span>
<span id="cb1-330"><a href="#cb1-330" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb1-331"><a href="#cb1-331" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(</span>
<span id="cb1-332"><a href="#cb1-332" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"Score vs. Enrollment"</span>,</span>
<span id="cb1-333"><a href="#cb1-333" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">"Enrollment"</span>,</span>
<span id="cb1-334"><a href="#cb1-334" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">"Score"</span>,</span>
<span id="cb1-335"><a href="#cb1-335" aria-hidden="true" tabindex="-1"></a>        <span class="at">color =</span> <span class="st">"Country"</span>,</span>
<span id="cb1-336"><a href="#cb1-336" aria-hidden="true" tabindex="-1"></a>        <span class="at">size =</span> <span class="st">"Rank"</span></span>
<span id="cb1-337"><a href="#cb1-337" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb1-338"><a href="#cb1-338" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb1-339"><a href="#cb1-339" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-340"><a href="#cb1-340" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Tab 2: Year Founded Analysis</span></span>
<span id="cb1-341"><a href="#cb1-341" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>year_rank_plot <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>({</span>
<span id="cb1-342"><a href="#cb1-342" aria-hidden="true" tabindex="-1"></a>    filtered_data <span class="ot">&lt;-</span> usNews_ranking <span class="sc">%&gt;%</span></span>
<span id="cb1-343"><a href="#cb1-343" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>((input<span class="sc">$</span>country <span class="sc">==</span> <span class="st">"All"</span> <span class="sc">|</span> country <span class="sc">==</span> input<span class="sc">$</span>country) <span class="sc">&amp;</span></span>
<span id="cb1-344"><a href="#cb1-344" aria-hidden="true" tabindex="-1"></a>               numeric_rank <span class="sc">&gt;=</span> input<span class="sc">$</span>rank_range[<span class="dv">1</span>] <span class="sc">&amp;</span></span>
<span id="cb1-345"><a href="#cb1-345" aria-hidden="true" tabindex="-1"></a>               numeric_rank <span class="sc">&lt;=</span> input<span class="sc">$</span>rank_range[<span class="dv">2</span>])</span>
<span id="cb1-346"><a href="#cb1-346" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-347"><a href="#cb1-347" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(filtered_data, <span class="fu">aes</span>(<span class="at">x =</span> year_founded, <span class="at">y =</span> score, <span class="at">color =</span> country)) <span class="sc">+</span></span>
<span id="cb1-348"><a href="#cb1-348" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb1-349"><a href="#cb1-349" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb1-350"><a href="#cb1-350" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(</span>
<span id="cb1-351"><a href="#cb1-351" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"Year Founded vs Score"</span>,</span>
<span id="cb1-352"><a href="#cb1-352" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">"Year Founded"</span>,</span>
<span id="cb1-353"><a href="#cb1-353" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">"Overall Score"</span>,</span>
<span id="cb1-354"><a href="#cb1-354" aria-hidden="true" tabindex="-1"></a>        <span class="at">color =</span> <span class="st">"Country"</span></span>
<span id="cb1-355"><a href="#cb1-355" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">+</span></span>
<span id="cb1-356"><a href="#cb1-356" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb1-357"><a href="#cb1-357" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb1-358"><a href="#cb1-358" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-359"><a href="#cb1-359" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Plot for Year Founded vs Score</span></span>
<span id="cb1-360"><a href="#cb1-360" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>year_score_plot <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>({</span>
<span id="cb1-361"><a href="#cb1-361" aria-hidden="true" tabindex="-1"></a>    filtered_data <span class="ot">&lt;-</span> usNews_ranking <span class="sc">%&gt;%</span></span>
<span id="cb1-362"><a href="#cb1-362" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>((input<span class="sc">$</span>country <span class="sc">==</span> <span class="st">"All"</span> <span class="sc">|</span> country <span class="sc">==</span> input<span class="sc">$</span>country) <span class="sc">&amp;</span></span>
<span id="cb1-363"><a href="#cb1-363" aria-hidden="true" tabindex="-1"></a>               numeric_rank <span class="sc">&gt;=</span> input<span class="sc">$</span>rank_range[<span class="dv">1</span>] <span class="sc">&amp;</span></span>
<span id="cb1-364"><a href="#cb1-364" aria-hidden="true" tabindex="-1"></a>               numeric_rank <span class="sc">&lt;=</span> input<span class="sc">$</span>rank_range[<span class="dv">2</span>])</span>
<span id="cb1-365"><a href="#cb1-365" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-366"><a href="#cb1-366" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(filtered_data, <span class="fu">aes</span>(<span class="at">x =</span> year_founded, <span class="at">y =</span> enrollment, <span class="at">color =</span> country)) <span class="sc">+</span></span>
<span id="cb1-367"><a href="#cb1-367" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb1-368"><a href="#cb1-368" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb1-369"><a href="#cb1-369" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(</span>
<span id="cb1-370"><a href="#cb1-370" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"Year Founded vs Enrollment"</span>,</span>
<span id="cb1-371"><a href="#cb1-371" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">"Year Founded"</span>,</span>
<span id="cb1-372"><a href="#cb1-372" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">"Enrollment"</span>,</span>
<span id="cb1-373"><a href="#cb1-373" aria-hidden="true" tabindex="-1"></a>        <span class="at">color =</span> <span class="st">"Country"</span></span>
<span id="cb1-374"><a href="#cb1-374" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">+</span></span>
<span id="cb1-375"><a href="#cb1-375" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb1-376"><a href="#cb1-376" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb1-377"><a href="#cb1-377" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-378"><a href="#cb1-378" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Tab 3: Map View</span></span>
<span id="cb1-379"><a href="#cb1-379" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>map_output <span class="ot">&lt;-</span> <span class="fu">renderLeaflet</span>({</span>
<span id="cb1-380"><a href="#cb1-380" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Filter the dataset based on selected country and city</span></span>
<span id="cb1-381"><a href="#cb1-381" aria-hidden="true" tabindex="-1"></a>    filtered_data <span class="ot">&lt;-</span> usNews_ranking <span class="sc">%&gt;%</span></span>
<span id="cb1-382"><a href="#cb1-382" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>((input<span class="sc">$</span>country <span class="sc">==</span> <span class="st">"All"</span> <span class="sc">|</span> country <span class="sc">==</span> input<span class="sc">$</span>country) <span class="sc">&amp;</span></span>
<span id="cb1-383"><a href="#cb1-383" aria-hidden="true" tabindex="-1"></a>               (input<span class="sc">$</span>city <span class="sc">==</span> <span class="st">"All"</span> <span class="sc">|</span> city <span class="sc">==</span> input<span class="sc">$</span>city) <span class="sc">&amp;</span></span>
<span id="cb1-384"><a href="#cb1-384" aria-hidden="true" tabindex="-1"></a>               numeric_rank <span class="sc">&gt;=</span> input<span class="sc">$</span>rank_range[<span class="dv">1</span>] <span class="sc">&amp;</span> </span>
<span id="cb1-385"><a href="#cb1-385" aria-hidden="true" tabindex="-1"></a>               numeric_rank <span class="sc">&lt;=</span> input<span class="sc">$</span>rank_range[<span class="dv">2</span>])  <span class="co"># Apply rank filtering</span></span>
<span id="cb1-386"><a href="#cb1-386" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-387"><a href="#cb1-387" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-388"><a href="#cb1-388" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Aggregate information for overlapping points</span></span>
<span id="cb1-389"><a href="#cb1-389" aria-hidden="true" tabindex="-1"></a>    aggregated_data <span class="ot">&lt;-</span> filtered_data <span class="sc">%&gt;%</span></span>
<span id="cb1-390"><a href="#cb1-390" aria-hidden="true" tabindex="-1"></a>      <span class="fu">group_by</span>(lat, long) <span class="sc">%&gt;%</span></span>
<span id="cb1-391"><a href="#cb1-391" aria-hidden="true" tabindex="-1"></a>      <span class="fu">summarise</span>(</span>
<span id="cb1-392"><a href="#cb1-392" aria-hidden="true" tabindex="-1"></a>        <span class="at">universities =</span> <span class="fu">paste</span>(university, <span class="at">collapse =</span> <span class="st">"; "</span>),</span>
<span id="cb1-393"><a href="#cb1-393" aria-hidden="true" tabindex="-1"></a>        <span class="at">rank_range =</span> <span class="fu">paste</span>(<span class="fu">min</span>(rank), <span class="st">"-"</span>, <span class="fu">max</span>(rank)),</span>
<span id="cb1-394"><a href="#cb1-394" aria-hidden="true" tabindex="-1"></a>        <span class="at">scores =</span> <span class="fu">paste</span>(score, <span class="at">collapse =</span> <span class="st">"; "</span>),</span>
<span id="cb1-395"><a href="#cb1-395" aria-hidden="true" tabindex="-1"></a>        <span class="at">enrollment_range =</span> <span class="fu">paste</span>(<span class="fu">min</span>(enrollment), <span class="st">"-"</span>, <span class="fu">max</span>(enrollment)),</span>
<span id="cb1-396"><a href="#cb1-396" aria-hidden="true" tabindex="-1"></a>        <span class="at">location =</span> <span class="fu">first</span>(location),</span>
<span id="cb1-397"><a href="#cb1-397" aria-hidden="true" tabindex="-1"></a>        <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb1-398"><a href="#cb1-398" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb1-399"><a href="#cb1-399" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-400"><a href="#cb1-400" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create the map</span></span>
<span id="cb1-401"><a href="#cb1-401" aria-hidden="true" tabindex="-1"></a>    <span class="fu">leaflet</span>(aggregated_data) <span class="sc">%&gt;%</span></span>
<span id="cb1-402"><a href="#cb1-402" aria-hidden="true" tabindex="-1"></a>      <span class="fu">addTiles</span>() <span class="sc">%&gt;%</span></span>
<span id="cb1-403"><a href="#cb1-403" aria-hidden="true" tabindex="-1"></a>      <span class="fu">addCircleMarkers</span>(</span>
<span id="cb1-404"><a href="#cb1-404" aria-hidden="true" tabindex="-1"></a>        <span class="at">lat =</span> <span class="sc">~</span>lat,</span>
<span id="cb1-405"><a href="#cb1-405" aria-hidden="true" tabindex="-1"></a>        <span class="at">lng =</span> <span class="sc">~</span>long,</span>
<span id="cb1-406"><a href="#cb1-406" aria-hidden="true" tabindex="-1"></a>        <span class="at">radius =</span> <span class="dv">5</span>,</span>
<span id="cb1-407"><a href="#cb1-407" aria-hidden="true" tabindex="-1"></a>        <span class="at">popup =</span> <span class="sc">~</span><span class="fu">paste</span>(</span>
<span id="cb1-408"><a href="#cb1-408" aria-hidden="true" tabindex="-1"></a>          <span class="st">"&lt;strong&gt;Universities:&lt;/strong&gt;&lt;br/&gt;"</span>, universities, <span class="st">"&lt;br/&gt;&lt;br/&gt;"</span>,</span>
<span id="cb1-409"><a href="#cb1-409" aria-hidden="true" tabindex="-1"></a>          <span class="st">"&lt;strong&gt;Rank Range:&lt;/strong&gt; "</span>, rank_range, <span class="st">"&lt;br/&gt;"</span>,</span>
<span id="cb1-410"><a href="#cb1-410" aria-hidden="true" tabindex="-1"></a>          <span class="st">"&lt;strong&gt;Scores:&lt;/strong&gt; "</span>, scores, <span class="st">"&lt;br/&gt;"</span>,</span>
<span id="cb1-411"><a href="#cb1-411" aria-hidden="true" tabindex="-1"></a>          <span class="st">"&lt;strong&gt;Enrollment Range:&lt;/strong&gt; "</span>, enrollment_range, <span class="st">"&lt;br/&gt;"</span>,</span>
<span id="cb1-412"><a href="#cb1-412" aria-hidden="true" tabindex="-1"></a>          <span class="st">"&lt;strong&gt;Location:&lt;/strong&gt; "</span>, location</span>
<span id="cb1-413"><a href="#cb1-413" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb1-414"><a href="#cb1-414" aria-hidden="true" tabindex="-1"></a>        <span class="at">color =</span> <span class="st">"blue"</span>,</span>
<span id="cb1-415"><a href="#cb1-415" aria-hidden="true" tabindex="-1"></a>        <span class="at">fillOpacity =</span> <span class="fl">0.7</span></span>
<span id="cb1-416"><a href="#cb1-416" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span></span>
<span id="cb1-417"><a href="#cb1-417" aria-hidden="true" tabindex="-1"></a>      <span class="fu">setView</span>(<span class="at">lng =</span> <span class="fu">mean</span>(filtered_data<span class="sc">$</span>long, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb1-418"><a href="#cb1-418" aria-hidden="true" tabindex="-1"></a>              <span class="at">lat =</span> <span class="fu">mean</span>(filtered_data<span class="sc">$</span>lat, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb1-419"><a href="#cb1-419" aria-hidden="true" tabindex="-1"></a>              <span class="at">zoom =</span> <span class="dv">2</span>)</span>
<span id="cb1-420"><a href="#cb1-420" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb1-421"><a href="#cb1-421" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-422"><a href="#cb1-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-423"><a href="#cb1-423" aria-hidden="true" tabindex="-1"></a><span class="fu">shinyApp</span>(ui, server)</span>
<span id="cb1-424"><a href="#cb1-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-425"><a href="#cb1-425" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb1-426"><a href="#cb1-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-427"><a href="#cb1-427" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part II A-Building an Interactive Dashborad with R Shiny</span></span>
<span id="cb1-428"><a href="#cb1-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-429"><a href="#cb1-429" aria-hidden="true" tabindex="-1"></a>In this study, three visualizations are created to understand the global university rankings. The first visualization compares the overall score and enrollment size. In the UI section, users can select the country (All – Turkey) and the rank range (#1 - #199), with enrollment as the x-coordinate and score as the y-coordinate. The color represents different countries, and a larger spot signifies a higher-ranked university. Among the top 50 global universities, Harvard, MIT, and Stanford are outliers with scores of 100.0, 96.9, and 94.5, respectively. The mean and median of the overall scores for the top 200 universities are 73.06 and 71.90, indicating that the distribution of scores is right-skewed due to universities like the three mentioned above. The distribution of enrollment is also right-skewed, with a mean of 32,269 and a median of 32,078. There is a slight positive correlation between scores and enrollment, suggesting that a top 200 university with more students is likely to be considered more prestigious. However, this relationship does not hold at the country level, as some countries either lack sufficient universities to show a trend or exhibit a flat relationship between the two variables, warranting further statistical analysis like linear regression analysis.</span>
<span id="cb1-430"><a href="#cb1-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-431"><a href="#cb1-431" aria-hidden="true" tabindex="-1"></a>The second output explores the relationships between the year founded, rank, and enrollment using two scatter plots. The founding year ranges from 1088 to 1968, with a mean of 1772 and a median of 1853, showing a left-skewed distribution, influenced by low outliers. A slight positive correlation is found between the score and the year founded, with newly founded universities tending to have higher scores. Similarly, the graph shows a positive relationship between the year founded and enrollment, although the correlation is relatively small. Based on these trends, it is likely that universities with a longer history recruit fewer students and are considered less competitive in terms of scores.</span>
<span id="cb1-432"><a href="#cb1-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-433"><a href="#cb1-433" aria-hidden="true" tabindex="-1"></a>The final output shows the geographical distribution of universities using the OSM method. Based on the map, it is clear that the top 200 universities are mostly clustered in the United States, central and northern Europe, China, and Australia. Regarding the distribution of the top 50 universities, most are located in the United States, particularly along the West and East Coasts, as well as in central and northern Europe, reflecting their dominant academic environments and histories as developed Western countries. Additionally, China, one of the leading developing countries, exhibits a strong academic culture, with more universities in the top 200 list than any other developing country. A previous study argued that U.S. economic success can be attributed to a well-educated labor force, noting that the London-based Times Higher Education’s 2009 list of the top 10 universities included six American universities, while China still had a long way to go (Nye Jr., 2010). Fifteen years later, the trend remains persistent, though Chinese universities have significantly improved, laying a strong foundation for the labor force. &nbsp;&nbsp;&nbsp;&nbsp;</span>
<span id="cb1-434"><a href="#cb1-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-435"><a href="#cb1-435" aria-hidden="true" tabindex="-1"></a>The report has adequately demonstrated the dominant academic performance in Western countries, while developing countries like China have also caught up in pace. Newly founded universities show strong and competitive academic performance in terms of rankings and large student enrollments, which diverges from that of historic universities. The quantitative benefits and graduate outcomes should be studied more specifically in the future to understand the rationale behind the two distinct strategies.</span>
<span id="cb1-436"><a href="#cb1-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-437"><a href="#cb1-437" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part II C-Critical Engagement with AI: Chat GPT</span></span>
<span id="cb1-438"><a href="#cb1-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-439"><a href="#cb1-439" aria-hidden="true" tabindex="-1"></a>This study actively engaged with Chat GPT AI for code refinement and language fluidity. Originally, the code for handling the “Load More” button clicked the button directly, but Chat GPT suggested using the <span class="in">`tryCatch`</span> function to prevent breaking the loop if it fails to catch and to add a sentence after clicking to indicate whether the action was successful. Additionally, though I was aware of it, Chat GPT helped confirm the correct code and split the score and enrollment data using <span class="in">`sequence`</span> and <span class="in">`by`</span>. During data wrangling, it used <span class="in">`\\d{4}`</span> to extract the four-digit year-founded data and clarified the geocode function to obtain geographical coordinates. For the Shiny app design, Chat GPT helped set the height parameter to enlarge the plot and map for better visibility. It also avoided label overlaps and reversed the dot size scale by using <span class="in">`ggrepel`</span> and <span class="in">`scale_size_continuous`</span>. In the map output, Chat GPT assisted in adding information for overlapping points on the map. Finally, it helped fit the tab panel.</span>
<span id="cb1-440"><a href="#cb1-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-441"><a href="#cb1-441" aria-hidden="true" tabindex="-1"></a>However, issues still arose during engagement with Chat GPT, including mismatched methods between its suggestions and the lecture methods. Sometimes, the methods Chat GPT provided were overly complicated or advanced and not applicable to the study. As a result, it was time-consuming to adjust them to an appropriate level. On the other hand, this presented an opportunity to learn new methods and theoretical concepts, which can benefit the user by introducing new techniques that can be adopted in the future.</span>
<span id="cb1-442"><a href="#cb1-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-443"><a href="#cb1-443" aria-hidden="true" tabindex="-1"></a><span class="fu">## Reference List</span></span>
<span id="cb1-444"><a href="#cb1-444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-445"><a href="#cb1-445" aria-hidden="true" tabindex="-1"></a>Horstschräer, J. (2012). University rankings in action? The importance of rankings and an excellence competition for university choice of high-ability students. *Economics of Education Review, 31*(6), 1162–1176. https://doi.org/10.1016/j.econedurev.2012.07.018</span>
<span id="cb1-446"><a href="#cb1-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-447"><a href="#cb1-447" aria-hidden="true" tabindex="-1"></a>Nye, J. S., Jr. (2010). The futures of American power: Dominance and decline in perspective. *Foreign Affairs, 89*(6), 2–12.</span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>